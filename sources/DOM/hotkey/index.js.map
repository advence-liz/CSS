{"version":3,"sources":["webpack:///webpack/bootstrap b3dcaf22e696241ab8ba","webpack:///./src/index.js","webpack:///./src/HotkeysManager.js"],"names":["hotkeysManager","print","$","document","on","e","text","currentTarget","outerHTML","showGlobal","setRootScope","HotkeysManager","scope","hotkeyMode","hotkeys_arr","globalScope","rootScope","$globalFlags","globalFlagMap","Map","$flags","flagMap","setScope","refreshScope","convertFlags2Map","toArray","map","element","flag","dataset","toUpperCase","set","toggleClass","length","state","undefined","_initEvent","keydown","bind","keyup","clickDocment","clickFlag","indexOf","key","push","keyCode","altKey","ctrlKey","keyCombination","join","cur_element","get","click","error","target","next","bubble","_init"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;AC7DA;;;;;;AAEA,IAAIA,iBAAiB,6BAAmB,YAAnB,CAArB;AACA,IAAIC,QAAQC,EAAE,QAAF,CAAZ;AACAA,EAAEC,QAAF,EAAYC,EAAZ,CAAe,OAAf,EAAwB,aAAxB,EAAuC,UAAUC,CAAV,EAAa;AAChDJ,UAAMK,IAAN,CAAWD,EAAEE,aAAF,CAAgBC,SAAhB,GAA4B,SAAvC;AACH,CAFD;AAGAR,eAAeS,UAAf,CAA0B,IAA1B;AACAT,eAAeU,YAAf,CAA4B,QAA5B,E;;;;;;;;;;;;ACRA;;;;;AAKA,SAASC,cAAT,CAAwBC,KAAxB,EAA+B;AAC3B,QAAIC,aAAa,KAAjB;AAAA,QAAwBJ,aAAa,KAArC;AACA,SAAKK,WAAL,GAAmB,EAAnB;AACA,SAAKC,WAAL,GAAmBH,KAAnB;AACA,SAAKI,SAAL,GAAiBJ,KAAjB;AACA,SAAKA,KAAL,GAAaA,KAAb;AACA,SAAKK,YAAL,GAAoB,IAAIf,CAAJ,EAApB,EACI,KAAKgB,aAAL,GAAqB,IAAIC,GAAJ,EADzB,EAEI,KAAKC,MAAL,GAAc,IAAIlB,CAAJ,EAFlB;AAGA,SAAKmB,OAAL,GAAe,IAAIF,GAAJ,EAAf;AACA,SAAKhB,QAAL,GAAgBD,EAAEC,QAAF,CAAhB;AACA,SAAKmB,QAAL,GAAgB,UAAUV,KAAV,EAAiB;;AAE7B,YAAI,KAAKC,UAAL,EAAJ,EAAuB;AACnB,iBAAKD,KAAL,GAAaA,KAAb;AACA,iBAAKW,YAAL;AACA,iBAAKF,OAAL,GAAe,KAAKG,gBAAL,CAAsB,KAAKJ,MAA3B,CAAf;;AAEA,mBAAO,IAAP;AACH,SAND,MAMO;AACH,mBAAO,KAAP;AACH;AAGJ,KAbD;AAcA;AACA,SAAKI,gBAAL,GAAwB,UAAUJ,MAAV,EAAkB;AACtC,YAAIC,UAAU,IAAIF,GAAJ,EAAd;AACAC,eAAOK,OAAP,GAAiBC,GAAjB,CAAqB,UAAUC,OAAV,EAAmB;AACpC,gBAAIC,OAAOD,QAAQE,OAAR,CAAgBD,IAAhB,CAAqBE,WAArB,EAAX;AACAT,oBAAQU,GAAR,CAAYH,IAAZ,EAAkBD,OAAlB;AACH,SAHD;AAIA,eAAON,OAAP;AAEH,KARD;AASA,SAAKE,YAAL,GAAoB,YAAY;AAC5B;AACA,aAAKH,MAAL,CAAYY,WAAZ,CAAwB,QAAxB,EAAkC,KAAlC;AACA;AACA,aAAKZ,MAAL,GAAclB,EAAE,iBAAiB,KAAKU,KAAtB,GAA8B,GAAhC,EAAqCoB,WAArC,CAAiD,QAAjD,EAA2D,IAA3D,CAAd;AACA,YAAI,CAAC,KAAKZ,MAAL,CAAYa,MAAjB,EAAyB;AACrB,gCAAkB,KAAKrB,KAAvB;AACH;AACJ,KARD;AASA,SAAKF,YAAL,GAAoB,UAAUE,KAAV,EAAiB;AACjC,aAAKI,SAAL,GAAiBJ,KAAjB;AACH,KAFD;AAGA;;;;;AAKA,SAAKC,UAAL,GAAkB,UAAUqB,KAAV,EAAiB;AAC/B,YAAIA,UAAUC,SAAd,EAAyB;AACrBtB,yBAAaqB,KAAb;AACH,SAFD,MAEO;AACH,mBAAOrB,UAAP;AACH;AACJ,KAND;AAOA,SAAKJ,UAAL,GAAkB,UAAUyB,KAAV,EAAiB;AAC/B,YAAIA,UAAUC,SAAd,EAAyB;AACrB1B,yBAAayB,KAAb;AACH,SAFD,MAEO;AACH,mBAAOzB,UAAP;AACH;AACJ,KAND;AAOA,SAAK2B,UAAL,GAAkB,YAAY;;AAE1B,aAAKjC,QAAL,CAAcC,EAAd,CAAiB,SAAjB,EAA4BiC,QAAQC,IAAR,CAAa,IAAb,CAA5B,EACKlC,EADL,CACQ,OADR,EACiBmC,MAAMD,IAAN,CAAW,IAAX,CADjB,EAEKlC,EAFL,CAEQ,OAFR,EAEiBoC,aAAaF,IAAb,CAAkB,IAAlB,CAFjB,EAGKlC,EAHL,CAGQ,OAHR,EAGiB,aAHjB,EAGgCqC,UAAUH,IAAV,CAAe,IAAf,CAHhC;AAIA;;;;AAIA,iBAASD,OAAT,CAAiBhC,CAAjB,EAAoB;AAChB,gBAAI,KAAKQ,UAAL,EAAJ,EAAuB;AACnB,qBAAKC,WAAL,CAAiB4B,OAAjB,CAAyBrC,EAAEsC,GAA3B,IAAkC,CAAC,CAAnC,GACI,IADJ,GAEI,KAAK7B,WAAL,CAAiB8B,IAAjB,CAAsBvC,EAAEsC,GAAxB,CAFJ;AAGH;AACD;AALA,iBAMK,IAAItC,EAAEwC,OAAF,KAAc,EAAd,IAAoBxC,EAAEyC,MAAtB,IAAgCzC,EAAE0C,OAAtC,EAA+C;AAChD,yBAAKlC,UAAL,CAAgB,IAAhB;AACA,yBAAKJ,UAAL,MAAqB,KAAKQ,YAAL,CAAkBe,WAAlB,CAA8B,QAA9B,EAAwC,IAAxC,CAArB;AACA,yBAAKV,QAAL,CAAc,KAAKN,SAAnB;AAEH;AACJ;AACD;;;;;AAKA,iBAASuB,KAAT,CAAelC,CAAf,EAAkB;;AAEd,gBAAI,KAAKQ,UAAL,EAAJ,EAAuB;AACnB,oBAAImC,iBAAiB,KAAKlC,WAAL,CAAiBmC,IAAjB,CAAsB,EAAtB,EAA0BnB,WAA1B,EAArB;AACA,oBAAI;;AAEA,wBAAI,KAAKjB,UAAL,EAAJ,EAAuB;AACnB,4BAAIqC,WAAJ;AACAA,sCAAc,KAAK7B,OAAL,CAAa8B,GAAb,CAAiBH,cAAjB,KAAoC,KAAK9B,aAAL,CAAmBiC,GAAnB,CAAuBH,cAAvB,CAAlD;AACAE,oCAAYE,KAAZ;AACH;AAGJ,iBATD,CASE,OAAOC,KAAP,EAAc;AACZ;AACH,iBAXD,SAWU;AACN,yBAAKvC,WAAL,CAAiBmB,MAAjB,GAA0B,CAA1B;AACH;AAEJ;AACD,mBAAO,KAAP;AACH;AACD;AACA,iBAASO,YAAT,CAAsBnC,CAAtB,EAAyB;AACrB,iBAAKe,MAAL,CAAYY,WAAZ,CAAwB,QAAxB,EAAkC,KAAlC;AACA,iBAAKf,YAAL,CAAkBe,WAAlB,CAA8B,QAA9B,EAAwC,KAAxC;AACA,iBAAKnB,UAAL,CAAgB,KAAhB;AACH;AACD;;;;;;;AAOA,iBAAS4B,SAAT,CAAmBpC,CAAnB,EAAsB;AAClB,gBAAI,KAAKQ,UAAL,MAAqBR,EAAEiD,MAAF,CAASzB,OAAT,CAAiB0B,IAA1C,EAAgD;AAC5C,qBAAKjC,QAAL,CAAcjB,EAAEiD,MAAF,CAASzB,OAAT,CAAiB0B,IAA/B;AACH,aAFD,MAEO;AACH,qBAAKnC,MAAL,CAAYY,WAAZ,CAAwB,QAAxB,EAAkC,KAAlC;AACA,qBAAKnB,UAAL,CAAgB,KAAhB;AACH;AACD,iBAAKI,YAAL,CAAkBe,WAAlB,CAA8B,QAA9B,EAAwC,KAAxC;AACA,mBAAO3B,EAAEiD,MAAF,CAASzB,OAAT,CAAiB2B,MAAjB,KAA4B,MAA5B,GAAqC,IAArC,GAA4C,KAAnD;AACH;AACJ,KA1ED;AA2EA,SAAKC,KAAL,GAAa,YAAY;;AAErB,aAAKrB,UAAL;AACA,aAAKA,UAAL,GAAkB,IAAlB;AACA,aAAKnB,YAAL,GAAoBf,EAAE,iBAAiBU,KAAjB,GAAyB,GAA3B,CAApB;AACA,aAAKM,aAAL,GAAqB,KAAKM,gBAAL,CAAsB,KAAKP,YAA3B,CAArB;AACH,KAND;AAOA,SAAKwC,KAAL;AACH;;kBAEc9C,c;AACf;AACA;AACA;AACA","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b3dcaf22e696241ab8ba","import HotkeysManager from \"./HotkeysManager\";\r\n\r\nvar hotkeysManager = new HotkeysManager('globalRoot');\r\nvar print = $(\"#print\");\r\n$(document).on(\"click\", '[data-flag]', function (e) {\r\n    print.text(e.currentTarget.outerHTML + \"clickd!\");\r\n});\r\nhotkeysManager.showGlobal(true);\r\nhotkeysManager.setRootScope(\"ScopeA\");\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\r\n * @class HotkeysManager\r\n * @param {String} scope 初始化 HotKeysManager 设置 RootScope\r\n * @desc\r\n */\r\nfunction HotkeysManager(scope) {\r\n    var hotkeyMode = false, showGlobal = false;\r\n    this.hotkeys_arr = [];\r\n    this.globalScope = scope;\r\n    this.rootScope = scope;\r\n    this.scope = scope;\r\n    this.$globalFlags = new $(),\r\n        this.globalFlagMap = new Map(),\r\n        this.$flags = new $();\r\n    this.flagMap = new Map();\r\n    this.document = $(document);\r\n    this.setScope = function (scope) {\r\n\r\n        if (this.hotkeyMode()) {\r\n            this.scope = scope;\r\n            this.refreshScope();\r\n            this.flagMap = this.convertFlags2Map(this.$flags);\r\n\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n\r\n\r\n    };\r\n    //convert Array to Map\r\n    this.convertFlags2Map = function ($flags) {\r\n        var flagMap = new Map();\r\n        $flags.toArray().map(function (element) {\r\n            var flag = element.dataset.flag.toUpperCase();\r\n            flagMap.set(flag, element);\r\n        });\r\n        return flagMap;\r\n\r\n    };\r\n    this.refreshScope = function () {\r\n        //取消上一次DOM\r\n        this.$flags.toggleClass('active', false);\r\n        //每次都重新获取DOM 元素，因为DOM元素可能动态渲染\r\n        this.$flags = $('[data-scope=' + this.scope + ']').toggleClass('active', true);\r\n        if (!this.$flags.length) {\r\n            throw `makesure ${this.scope} really exist`;\r\n        }\r\n    };\r\n    this.setRootScope = function (scope) {\r\n        this.rootScope = scope;\r\n    };\r\n    /**\r\n     * hotkeyMode 读写器\r\n     * @param {Bool} state  读写器\r\n     * @return {Bool} hotKeyMode \r\n     */\r\n    this.hotkeyMode = function (state) {\r\n        if (state !== undefined) {\r\n            hotkeyMode = state;\r\n        } else {\r\n            return hotkeyMode;\r\n        }\r\n    };\r\n    this.showGlobal = function (state) {\r\n        if (state !== undefined) {\r\n            showGlobal = state;\r\n        } else {\r\n            return showGlobal;\r\n        }\r\n    };\r\n    this._initEvent = function () {\r\n\r\n        this.document.on('keydown', keydown.bind(this))\r\n            .on('keyup', keyup.bind(this))\r\n            .on('click', clickDocment.bind(this))\r\n            .on(\"click\", '[data-flag]', clickFlag.bind(this));\r\n        /**\r\n         * 开启hotkeyMode，或者记录按下的快捷键\r\n         * @param {*} e event\r\n         */\r\n        function keydown(e) {\r\n            if (this.hotkeyMode()) {\r\n                this.hotkeys_arr.indexOf(e.key) > -1 ?\r\n                    null :\r\n                    this.hotkeys_arr.push(e.key);\r\n            }\r\n            //开启hotkeyMode 经测试感觉keydown的时候开学hotkeyMode 比较好\r\n            else if (e.keyCode === 90 && e.altKey && e.ctrlKey) {\r\n                this.hotkeyMode(true);\r\n                this.showGlobal() && this.$globalFlags.toggleClass('active', true);\r\n                this.setScope(this.rootScope);\r\n              \r\n            }\r\n        }\r\n        /**\r\n         * 判断键入的组合键是否匹配预先设置的组合键，如果满足则触发对应元素的 click 事件\r\n         * @param {*} e Event\r\n         * @return {Bool} 阻止事件冒泡 阻止document click 触发\r\n         */\r\n        function keyup(e) {\r\n\r\n            if (this.hotkeyMode()) {\r\n                var keyCombination = this.hotkeys_arr.join('').toUpperCase();\r\n                try {\r\n\r\n                    if (this.hotkeyMode()) {\r\n                        var cur_element;\r\n                        cur_element = this.flagMap.get(keyCombination) || this.globalFlagMap.get(keyCombination);\r\n                        cur_element.click();\r\n                    }\r\n\r\n\r\n                } catch (error) {\r\n                    //  console.error(error);\r\n                } finally {\r\n                    this.hotkeys_arr.length = 0;\r\n                }\r\n\r\n            }\r\n            return false;\r\n        }\r\n        //当点击页面任何位置移除$flags激活状态\r\n        function clickDocment(e) {\r\n            this.$flags.toggleClass('active', false);\r\n            this.$globalFlags.toggleClass('active', false);\r\n            this.hotkeyMode(false);\r\n        }\r\n        /**\r\n         * data-flag 元素click触发如果不阻止事件冒泡，那么 docment的click 就会触发hotMode就会变为false\r\n         * 所以只能让大家在自己事件上阻止冒泡，我要是直接阻止冒泡我担心这个元素并不是触发事件的元素\r\n         * 根据属性配置是否阻止事件冒泡\r\n         * @param {*} e Event\r\n         * @return {Bool} 是否阻止事件冒泡\r\n         */\r\n        function clickFlag(e) {\r\n            if (this.hotkeyMode() && e.target.dataset.next) {\r\n                this.setScope(e.target.dataset.next);\r\n            } else {\r\n                this.$flags.toggleClass('active', false);\r\n                this.hotkeyMode(false);\r\n            }\r\n            this.$globalFlags.toggleClass('active', false);\r\n            return e.target.dataset.bubble === \"true\" ? true : false;\r\n        }\r\n    };\r\n    this._init = function () {\r\n\r\n        this._initEvent();\r\n        this._initEvent = null;\r\n        this.$globalFlags = $('[data-scope=' + scope + ']');\r\n        this.globalFlagMap = this.convertFlags2Map(this.$globalFlags);\r\n    };\r\n    this._init();\r\n}\r\n\r\nexport default HotkeysManager;\r\n//TODO\r\n//1 flag 大小写\r\n//2 add globaRootMap\r\n/**\r\n * 1 ctrl+alt+z when keyup 展示当前 RootScope\r\n * 2 键盘输入一个Key 触发对应DOM 元素的click事件 根据next 切换到对应的ChildScope\r\n */\n\n\n// WEBPACK FOOTER //\n// ./src/HotkeysManager.js"],"sourceRoot":""}